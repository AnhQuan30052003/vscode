import os
from Crypto.PublicKey import RSA
from Crypto.Cipher import PKCS1_OAEP
from Crypto.Random import get_random_bytes


# Tạo cặp khóa RSA
key = RSA.generate(2048)
private_key = key.export_key()
public_key = key.export_key()

def RSA_crypto(message: bytes):
  cipher_rsa = PKCS1_OAEP.new(RSA.import_key(public_key))
  encrypted_message = cipher_rsa.encrypt(message)

  # Hiển thị mã hoá dưới dạng hệ 16 (hex)
  print("Encrypted message (hex):", encrypted_message)

  # Giải mã thông điệp
  cipher_rsa = PKCS1_OAEP.new(RSA.import_key(private_key))
  decrypted_message = cipher_rsa.decrypt(encrypted_message)

  print("Decrypted message:", decrypted_message)


os.system("cls")
# message = b"quan"
# message = b"q\x1e\xc3\x97\x1a$\xc3\xbdb\xc2\x8dE\xc2\xa1mPx\xc2\xb9)\xc3\xaej\xc2\x9d\xc2\xbf\xc3\x86'\xc2\x92fn\xc2\xbd\xc3\xbemh\xc3\x8b\xc2\x85\xc3\xbfdX\x16\xc3\xbe\xc3\x88\x06(4a\xc3\xaeZ\xc2\x91\xc3\x93\x07s\xc3\xb4\xc3\xadV,\xc3\xaf\xc3\x93\xc3\x81\xc2\x82\x1d\x14\xc3\xa9)\xc3\xb4DVH\x16B\xc2\x98\xc2\x84\xc2\xbd\xc3\xb7\xc3\xa0\xc2\x8c\xc2\x81\xc3\xbc\xc2\xb5\xc2\xb1[#\xc3\xab\xc3\xa1\x19\xc3\x9cj\xc3\xbc\xc2\x88\xc3\x88<%\x1cN\xc3\x8a\x19m8{7P\xc3\x81\xc2\xb2\xc3\x88gx\xc3\x98\xc2\xbe\xc3\x98\x12\xc2\x85\xc2\xb1\xc3\x8c\x04\xc3\x89\xc2\x9d\xc2\xb8\x05g\xc3\xa5\xc3\xb5\xc3\xb5\xc2\xba]\xc2\xaf\x06n\xc3\x90\xc3\x94br\xc2\x91<4\x1e\xc2\xbc\xc3\x89\xc2\x89a\x0f\xc3\xa4\xc3\x92Hu\xc3\x90\xc2\xa2\xc2\xb7\xc2\xaa\x03\xc2\x93\xc3\x8a\xc2\x84\x18!y=\xc3\xa0+\x06:\xc2\xa1\xc2\xa8\x13Y\xc2\xac;\xc2\xab|\xc2\xad\xc3\xb9g\x14R.\xc2\xa4\xc3\xa9\xc2\x9a\xc3\xbe\xc3\x92\xc2\xb3\xc2\x9b4\xc2\xb6\xc2\x98<?|9G\xc3\xb29\xc3\x8a\xc3\x86\xc3\x9d\xc3\xb8i\xc3\x8f\xc3\x9b\xc2\x9arm5\x12\xc3\x84A\x1eK\xc2\x954\xc3\xac\xc2\x90X\xc3\xb89\xc2\xb6\xc3\xb7\xc2\x93b\xc2\xac\xc3\xacm5o\xc2\xa9\xc3\x81XYu\xc2\x86\xc2\x89\xc3\xa7p\x196H\xc2\xaa\x0c\xc3\xa3Uz\xc2\x9f-\xc2\x86Nc\xc3\xaf\xc3\xb4(\xc2\x87\xc3\x92\x00?>\x1d\x072\xc2\x98\xc2\xb17\xc3\x88\xc3\x87\xc2\x94"
message = b"import os"
RSA_crypto(message)